---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import ScrollHero from '../components/ScrollHero.astro';
import ProductCard from '../components/ProductCard.astro';
import ProductModal from '../components/ProductModal.astro';
import Carousel from '../components/Carousel.astro';
import Footer from '../components/Footer.astro';
import { getCollection } from 'astro:content';

const allProducts = await getCollection('products');

// Sort by display_order (lower = first), fallback to 50
const sortByOrder = (a: any, b: any) =>
    (a.data.display_order ?? 50) - (b.data.display_order ?? 50);

// CMS-driven section filtering
const featured = allProducts.filter(p => p.data.featured).sort(sortByOrder);
const onSale   = allProducts.filter(p => p.data.on_sale).sort(sortByOrder);
const allSorted = [...allProducts].sort(sortByOrder);
---

<Layout>
    <Header />
    
    <main>
        <!-- 1. CINEMATIC SCROLL HERO -->
        <ScrollHero />

        <!-- 2. FEATURED COLLECTION — Carousel -->
        {featured.length > 0 && <Carousel title="Featured Collection" products={featured} />}

        <!-- 3. ON SALE — Carousel -->
        {onSale.length > 0 && <Carousel title="On Sale" products={onSale} variant="sale" />}

        <!-- 4. OUR COLLECTION — Full Grid -->
        <section id="collection" class="py-16 relative">
            <div class="absolute inset-0 bg-gradient-section pointer-events-none"></div>
            <div class="container mx-auto px-6 relative z-10">
                <div class="text-center mb-12 reveal">
                    <h2 class="text-3xl md:text-4xl font-serif text-cream mb-3">Our Collection</h2>
                    <div class="gold-line"></div>
                    <p class="text-muted text-sm mt-4 max-w-lg mx-auto">Each fragrance is a story, crafted to evoke emotion and make every moment unforgettable.</p>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
                    {allSorted.map((product, i) => (
                        <div class={`reveal reveal-delay-${(i % 4) + 1}`}>
                            <ProductCard product={product} />
                        </div>
                    ))}
                </div>
            </div>
        </section>

        <!-- 5. NICHE & LUXURY COLLECTION (SEO block) -->
        <section id="niche-collection" class="py-16 relative">
            <div class="absolute inset-0 pointer-events-none">
                <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[400px] h-[400px] bg-accent/[0.02] blur-[100px] rounded-full"></div>
            </div>
            <div class="container mx-auto px-6 max-w-4xl text-center relative z-10 reveal">
                <h2 class="text-3xl font-serif text-cream mb-6">High-End & Niche Perfume Collection in Bangladesh</h2>
                <p class="text-muted leading-relaxed font-light mb-8">
                    For the connoisseurs of fine fragrances. Explore our <strong class="text-cream font-normal">exclusive fragrance collection BD</strong>. We specialize in bringing the essence of an <strong class="text-cream font-normal">original French perfume in Bangladesh</strong> directly to you. Dive into our rich, <strong class="text-cream font-normal">authentic Arabian perfume BD</strong> and exquisite <strong class="text-cream font-normal">premium oud perfume Bangladesh</strong> selections, defining the true <strong class="text-cream font-normal">niche perfume Bangladesh</strong> experience.
                </p>
                <div class="gold-line"></div>
            </div>
        </section>

        <!-- 6. NATIONWIDE DELIVERY -->
        <section id="delivery" class="py-16 relative">
            <div class="container mx-auto px-6 max-w-4xl text-center reveal">
                <h2 class="text-3xl font-serif text-cream mb-6">Perfume Delivery All Over Bangladesh</h2>
                <p class="text-muted leading-relaxed font-light mb-8">
                    As a <strong class="text-cream font-normal">trusted perfume shop online BD</strong>, we ensure safe and fast delivery. <strong class="text-cream font-normal">Buy authentic perfume online BD</strong> and enjoy our <strong class="text-cream font-normal">original perfume cash on delivery BD</strong> service. Nationwide delivery across Bangladesh — your signature scent is just a click away.
                </p>
                <div class="gold-line"></div>
            </div>
        </section>

        <!-- 7. PERFUME GIFTS (SEO block) -->
        <section id="gifts" class="py-16 relative">
            <div class="absolute inset-0 pointer-events-none">
                <div class="absolute top-0 right-0 w-[300px] h-[300px] bg-accent/[0.02] blur-[80px] rounded-full"></div>
            </div>
            <div class="container mx-auto px-6 max-w-4xl text-center relative z-10 reveal">
                <h2 class="text-3xl font-serif text-cream mb-6">Luxury Perfume Gift Sets in Bangladesh</h2>
                <p class="text-muted leading-relaxed font-light">
                    Give the gift of luxury. Perfect for any occasion, our sets are the ideal <strong class="text-cream font-normal">premium perfume gift set Bangladesh</strong>. Whether you need a memorable <strong class="text-cream font-normal">wedding perfume gift set BD</strong>, a romantic <strong class="text-cream font-normal">Valentine's Day perfume gift BD</strong>, or a thoughtful <strong class="text-cream font-normal">anniversary perfume gift Bangladesh</strong>, we have the perfect fragrance for your loved ones.
                </p>
            </div>
        </section>

        <!-- FAQ Schema -->
        <script type="application/ld+json">
        {
          "@context": "https://schema.org",
          "@type": "FAQPage",
          "mainEntity": [
            {
              "@type": "Question",
              "name": "Where can I buy authentic premium perfume in Bangladesh?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "You can buy authentic premium perfumes online from SCENTER with guaranteed originality and cash on delivery all over Bangladesh."
              }
            },
            {
              "@type": "Question",
              "name": "Do you deliver perfume outside Dhaka?",
              "acceptedAnswer": {
                "@type": "Answer",
                "text": "Yes, we offer nationwide delivery across Bangladesh with secure packaging."
              }
            }
          ]
        }
        </script>
    </main>

    <ProductModal />
    <Footer />
</Layout>
